"use strict";(self.webpackChunkdocs_v_2=self.webpackChunkdocs_v_2||[]).push([[3537],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return c}});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),u=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return i.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),m=u(n),c=o,h=m["".concat(s,".").concat(c)]||m[c]||d[c]||a;return n?i.createElement(h,l(l({ref:t},p),{},{components:n})):i.createElement(h,l({ref:t},p))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=m;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:o,l[1]=r;for(var u=2;u<a;u++)l[u]=n[u];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},52595:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return u},metadata:function(){return p},toc:function(){return d},default:function(){return c}});var i=n(83117),o=n(80102),a=(n(67294),n(3905)),l=n(44996),r=["components"],s={title:"Building Custom Viz Plugins",hide_title:!0,sidebar_position:11,version:1},u=void 0,p={unversionedId:"installation/building-custom-viz-plugins",id:"installation/building-custom-viz-plugins",title:"Building Custom Viz Plugins",description:'This is a tutorial to help you build a "Hello World" viz plugin. The intent is to provide a basic',source:"@site/docs/installation/building-custom-viz-plugins.mdx",sourceDirName:"installation",slug:"/installation/building-custom-viz-plugins",permalink:"/docs/installation/building-custom-viz-plugins",editUrl:"https://github.com/apache/superset/tree/master/docs/docs/installation/building-custom-viz-plugins.mdx",tags:[],version:"current",sidebarPosition:11,frontMatter:{title:"Building Custom Viz Plugins",hide_title:!0,sidebar_position:11,version:1},sidebar:"tutorialSidebar",previous:{title:"SQL Templating",permalink:"/docs/installation/sql-templating"},next:{title:"Running on Kubernetes",permalink:"/docs/installation/running-on-kubernetes"}},d=[{value:"Getting Set Up",id:"getting-set-up",children:[{value:"Install Yeoman and the Superset Package Generator",id:"install-yeoman-and-the-superset-package-generator",children:[],level:3},{value:"Install Superset",id:"install-superset",children:[],level:3},{value:"Install Superset-UI",id:"install-superset-ui",children:[],level:3}],level:2},{value:"Build Your &quot;Hello, World&quot;",id:"build-your-hello-world",children:[{value:"<del>Write</del> <em>generate</em> some code!",id:"write-generate-some-code",children:[],level:3},{value:"Add your Plugin to Superset (with NPM Link)",id:"add-your-plugin-to-superset-with-npm-link",children:[],level:3},{value:"See it with your own eyes!",id:"see-it-with-your-own-eyes",children:[],level:3}],level:2},{value:"Make it Your Own",id:"make-it-your-own",children:[{value:"Read the comments and docs",id:"read-the-comments-and-docs",children:[],level:3},{value:"Take control!",id:"take-control",children:[],level:3},{value:"Build the perfect query",id:"build-the-perfect-query",children:[],level:3},{value:"Style with Emotion",id:"style-with-emotion",children:[],level:3},{value:"Give it a thumbnail",id:"give-it-a-thumbnail",children:[],level:3},{value:"Build it!",id:"build-it",children:[],level:3},{value:"Test early, test often!",id:"test-early-test-often",children:[],level:3},{value:"Deploying Custom Visualization to Production",id:"deploying-custom-visualization-to-production",children:[],level:3}],level:2}],m={toc:d};function c(e){var t=e.components,n=(0,o.Z)(e,r);return(0,a.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,'This is a tutorial to help you build a "Hello World" viz plugin. The intent is to provide a basic\nscaffolding to build any sort of data visualization, using any viz libary you\'d like (e.g. ECharts,\nAntV, HighCharts, VX, and D3.).'),(0,a.kt)("p",null,"You can build the Hello World plugin by running a ",(0,a.kt)("a",{parentName:"p",href:"https://yeoman.io/"},"Yeoman")," generator, which\ntakes a few simple options, and provides this plugin scaffolding."),(0,a.kt)("h2",{id:"getting-set-up"},"Getting Set Up"),(0,a.kt)("h3",{id:"install-yeoman-and-the-superset-package-generator"},"Install Yeoman and the Superset Package Generator"),(0,a.kt)("p",null,"This Hello World plugin we'll be building is generated automatically with\n",(0,a.kt)("a",{parentName:"p",href:"https://yeoman.io/"},"Yeoman"),". Let's first get that installed by opening up a terminal and installing\nboth the ",(0,a.kt)("inlineCode",{parentName:"p"},"yo")," module and the\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache-superset/superset-ui/tree/master/packages/generator-superset"},"superset package generator"),"\n(",(0,a.kt)("inlineCode",{parentName:"p"},"v0.14.7"),") to create the new plugin."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"npm install -g yo @superset-ui/generator-superset\n")),(0,a.kt)("h3",{id:"install-superset"},"Install Superset"),(0,a.kt)("p",null,"There are\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/superset#installation-and-configuration"},"complete instructions"),"\navailable on the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/superset"},"Superset Github repository"),". In a\nnutshell, the easiest way is to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Have a Mac or linux-based machine"),(0,a.kt)("li",{parentName:"ol"},"Install ",(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/get-docker/"},"Docker")),(0,a.kt)("li",{parentName:"ol"},"Clone ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache/superset"},"the repository")," to your computer"),(0,a.kt)("li",{parentName:"ol"},"Use your terminal to ",(0,a.kt)("inlineCode",{parentName:"li"},"cd")," into the ",(0,a.kt)("inlineCode",{parentName:"li"},"superset")," directory"),(0,a.kt)("li",{parentName:"ol"},"Run ",(0,a.kt)("inlineCode",{parentName:"li"},"docker-compose up")),(0,a.kt)("li",{parentName:"ol"},"Open ",(0,a.kt)("em",{parentName:"li"},"another")," terminal, and ",(0,a.kt)("inlineCode",{parentName:"li"},"cd")," into ",(0,a.kt)("inlineCode",{parentName:"li"},"superset/superset-frontend")),(0,a.kt)("li",{parentName:"ol"},"Run ",(0,a.kt)("inlineCode",{parentName:"li"},"npm install")," to load up all the npm packages."),(0,a.kt)("li",{parentName:"ol"},"Run ",(0,a.kt)("inlineCode",{parentName:"li"},"npm run dev-server")," to spin up the Webpack hot-reloading server"),(0,a.kt)("li",{parentName:"ol"},"Wait for it to build, and then open your browser to ",(0,a.kt)("inlineCode",{parentName:"li"},"http://localhost:9000")," and log in with\n",(0,a.kt)("inlineCode",{parentName:"li"},"admin"),"/",(0,a.kt)("inlineCode",{parentName:"li"},"admin"),". You're off to the races! (Note: we'll be restarting this later)")),(0,a.kt)("h3",{id:"install-superset-ui"},"Install Superset-UI"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Clone ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/apache-superset/superset-ui"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"superset-ui")," repository")," to your\ncomputer. It can sit in the same parent directory as your ",(0,a.kt)("inlineCode",{parentName:"li"},"superset")," repo"),(0,a.kt)("li",{parentName:"ol"},"Use your terminal to ",(0,a.kt)("inlineCode",{parentName:"li"},"cd")," into ",(0,a.kt)("inlineCode",{parentName:"li"},"superset-ui")),(0,a.kt)("li",{parentName:"ol"},"Run ",(0,a.kt)("inlineCode",{parentName:"li"},"yarn install")," and wait for all the packages to get installed")),(0,a.kt)("h2",{id:"build-your-hello-world"},'Build Your "Hello, World"'),(0,a.kt)("h3",{id:"write-generate-some-code"},(0,a.kt)("del",{parentName:"h3"},"Write")," ",(0,a.kt)("em",{parentName:"h3"},"generate")," some code!"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Using your terminal, ",(0,a.kt)("inlineCode",{parentName:"li"},"cd")," into your local ",(0,a.kt)("inlineCode",{parentName:"li"},"superset-ui")," repo folder and then into the ",(0,a.kt)("inlineCode",{parentName:"li"},"plugins"),"\nsubdirectory."),(0,a.kt)("li",{parentName:"ol"},"Make a new directory for your plugin, i.e. ",(0,a.kt)("inlineCode",{parentName:"li"},"mkdir plugin-chart-hello-world"),". ",(0,a.kt)("strong",{parentName:"li"},"Note:")," we\n",(0,a.kt)("em",{parentName:"li"},"highly")," recommend following the ",(0,a.kt)("inlineCode",{parentName:"li"},"plugin-chart-your-plugin-name")," pattern."),(0,a.kt)("li",{parentName:"ol"},"Now ",(0,a.kt)("inlineCode",{parentName:"li"},"cd plugin-chart-hello-world")),(0,a.kt)("li",{parentName:"ol"},"Finally, run ",(0,a.kt)("inlineCode",{parentName:"li"},"yo @superset-ui/superset")),(0,a.kt)("li",{parentName:"ol"},"Select ",(0,a.kt)("inlineCode",{parentName:"li"},"Create superset-ui chart plugin package")," on the following screen:")),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-1-yeoman-select.png")})," ",(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Give it a name (in our case, go with the default, based on the folder name):"),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-2-yeoman-package-name.png")})),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Give it a description (again, default is fine!)"),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-3-yeoman-description.png")})," "),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Choose which type of React component you want to make (Class, or Function component)."),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-4-yeoman-component-type.png")})," "),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Select whether you'd like your visualization to be timeseries-based or not"),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-5-yeoman-timeseries.png")})," "),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Select whether or not you want to include badges at the top of your README file (really only\nneeded if you intend to contribute your plugin to the ",(0,a.kt)("inlineCode",{parentName:"p"},"superset-ui")," repo)."),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-6-yeoman-badges.png")})," "),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Admire all the files the generator has created for you. Note that EACH of these is chock full of\ncomments about what they're for, and how best to use them."),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-7-yeoman-files.png")})," ")),(0,a.kt)("h3",{id:"add-your-plugin-to-superset-with-npm-link"},"Add your Plugin to Superset (with NPM Link)"),(0,a.kt)("p",null,"Now, we want to see this thing actually RUN! To do that, we'll add your package to Superset and\nembrace the magic power of ",(0,a.kt)("inlineCode",{parentName:"p"},"npm link")," to see it in-situ, without needing to ",(0,a.kt)("strong",{parentName:"p"},"build")," the plugin, or\nopen any PRs on Github."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Add your package to the ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json")," file in ",(0,a.kt)("inlineCode",{parentName:"p"},"superset/superset-frontend"),"."),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-8-package-json.png")})," ")),(0,a.kt)("p",null,"Note: Do ",(0,a.kt)("em",{parentName:"p"},"not")," run ",(0,a.kt)("inlineCode",{parentName:"p"},"npm install"),"... explanation below."),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Add your plugin to the ",(0,a.kt)("inlineCode",{parentName:"p"},"MainPreset.js")," file (located in\n",(0,a.kt)("inlineCode",{parentName:"p"},"superset/superset-frontend/src/visualizations/presets/MainPreset.js"),") in two places,\nalongside the other plugins."),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-9-mainpreset-import.png")})," ",(0,a.kt)("p",{parentName:"li"},"{' '}"),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-9-mainpreset-register.png")})),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Open a terminal window to ",(0,a.kt)("inlineCode",{parentName:"p"},"superset/superset-frontend"),". If you did the Install Superset\nsteps above, you may still have webpack running there, and you can just stop it with ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrol-c"),".\nIf not, just open a new window and or ",(0,a.kt)("inlineCode",{parentName:"p"},"cd")," to that directory path."))),(0,a.kt)("p",null,"4) Use ",(0,a.kt)("inlineCode",{parentName:"p"},"npm link")," to symlink plugin, using a relative path to ",(0,a.kt)("inlineCode",{parentName:"p"},"superset-ui")," and your plugin folder,\ne.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"npm link ../../superset-ui/plugins/plugin-chart-hello-world"),"."),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Restart your webpack dev server with ",(0,a.kt)("inlineCode",{parentName:"li"},"npm run dev-server"),". You'll know it worked if you see a\nline stating\n",(0,a.kt)("inlineCode",{parentName:"li"},"[Superset Plugin] Use symlink source for @superset-ui/plugin-chart-hello-world @ ^0.0.0"),".")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"NOTE:")," If/when you do an ",(0,a.kt)("inlineCode",{parentName:"p"},"npm install")," that erases the symlink generated by ",(0,a.kt)("inlineCode",{parentName:"p"},"npm link"),", so you'll\nhave to redo those steps."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"NOTE:")," Dynamic import is a work in progress. We hope you won't even need to DO this soon. We'll\nbe blogging again when that day comes, we assure you. In short, we have a goal to make editing\n",(0,a.kt)("inlineCode",{parentName:"p"},"package.json")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"MainPreset.js")," unnecessary, so all the code changes are made in ONE repo."),(0,a.kt)("h3",{id:"see-it-with-your-own-eyes"},"See it with your own eyes!"),(0,a.kt)("p",null,"You should now be able to go to the Explore view in your local Superset and add a new chart! You'll\nsee your new plugin when you go to select your viz type."),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-10-hello-thumbnail.png")})," ",(0,a.kt)("p",null,"Now you can load up some data, and you'll see it appear in the plugin!"),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-11-explore-view.png")})," ",(0,a.kt)("p",null,"The plugin also outputs three things to your browser's console:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"formData"),", a.k.a. everything sent into your viz from the controls"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"props"),", as output from the ",(0,a.kt)("inlineCode",{parentName:"li"},"transformProps")," file for your plugin's consumption"),(0,a.kt)("li",{parentName:"ul"},"The actual HTML element, which your plugin has hooks into for any necessary DOM maniupluation")),(0,a.kt)("img",{src:(0,l.Z)("/img/custom-plugins/plugin-12-console-logs.png")})," ",(0,a.kt)("h2",{id:"make-it-your-own"},"Make it Your Own"),(0,a.kt)("p",null,"Now you're free to run wild with your new plugin! Here are a few places to start digging in:"),(0,a.kt)("h3",{id:"read-the-comments-and-docs"},"Read the comments and docs"),(0,a.kt)("p",null,"Take a look through the full file tree of the plugin. The Readme gives details for the job of each\nfile. EACH of these files has been annotated with extensive comments of what the file is for, and\nthe basics of what you can do with it."),(0,a.kt)("h3",{id:"take-control"},"Take control!"),(0,a.kt)("p",null,"The plugin includes a couple of example controls, but you can certainly continue to add as many as\nyou need to. The comments/documentation within the controls file is a start, but we recommend\nlooking at existing ",(0,a.kt)("inlineCode",{parentName:"p"},"superset-ui")," plugins for more examples of how you can implement controls to\nenhance your queries, work with your data, and change your visualization's display."),(0,a.kt)("h3",{id:"build-the-perfect-query"},"Build the perfect query"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"buildQuery"),' file where your plugin actually fetches data from the Superset backend. This file\nbuilds he query "context" for your plugin. For a simple plugin, this file needn\'t do much. There are\na couple changes that need to be made for a timeseries plugin, thus the option in the Yeoman\ngenerator.'),(0,a.kt)("p",null,"This file also allows you to add various post-processing operations, to have the Superset backend\nprocess your data in various ways (pivoting, etc), but that's a whole other topic we'll cover\nseparately in the near future."),(0,a.kt)("h3",{id:"style-with-emotion"},"Style with Emotion"),(0,a.kt)("p",null,"Each of these methods lets you add custom CSS styles using Emotion \ud83d\udc69\u200d\ud83c\udfa4(a CSS-in-JS approach) which\nhas access to Superset's burgeoning set of theme variables, and also automatically scopes the styles\nto your plugin, so they don't \"leak\" to other areas of Superset."),(0,a.kt)("p",null,"In the Hello World plugin, we've included a few example Theme variables (",(0,a.kt)("inlineCode",{parentName:"p"},"colors"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"gridUnit"),"s, and\ntypographic weights/sizes). We'll be continuing to add more variables to this theme file as we\ncontinue to push Superset (and the viz plugins) toward the standards of the Superset redesign (see\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/superset/issues/8976"},"SIP-34"),")"),(0,a.kt)("h3",{id:"give-it-a-thumbnail"},"Give it a thumbnail"),(0,a.kt)("p",null,"Because come on... that's the fun part, right?"),(0,a.kt)("h3",{id:"build-it"},"Build it!"),(0,a.kt)("p",null,"In this tutorial, you built your plugin in the ",(0,a.kt)("inlineCode",{parentName:"p"},"superset-ui")," repo. This means you can use the\nbuilt-in build scripts that the repo provides. With your terminal of choice, simply ",(0,a.kt)("inlineCode",{parentName:"p"},"cd")," into the\nroot directory of ",(0,a.kt)("inlineCode",{parentName:"p"},"supeset-ui")," and run ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn build"),". This will kick off a build of ALL the Superset\nplugins and packages, including yours."),(0,a.kt)("h3",{id:"test-early-test-often"},"Test early, test often!"),(0,a.kt)("p",null,"The Hello World plugin includes some basic Jest tests to act as a starting point to add unit tests\nto your plugin. These do a quick sanity check that the plugin actually loads correctly, and then run\nthrough the basics of making sure that your controls are properly respected by modifying the\nresulting data and/or props of the plugin. Running ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn test")," from the root directory of\n",(0,a.kt)("inlineCode",{parentName:"p"},"superset-ui")," will run all the tests for plugins/packages, including your Hello World."),(0,a.kt)("h3",{id:"deploying-custom-visualization-to-production"},"Deploying Custom Visualization to Production"),(0,a.kt)("p",null,"To deploy plugins to a production environment, you must have additional code\ninside Superset that includes the npm packages of your plugins so they can be installed in the frontend."),(0,a.kt)("p",null,"One option is to build your Dockerfile so it contains your custom visualization packages."))}c.isMDXComponent=!0}}]);