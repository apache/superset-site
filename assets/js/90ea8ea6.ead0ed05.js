"use strict";(self.webpackChunkdocs_v_2=self.webpackChunkdocs_v_2||[]).push([[74],{91288:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=s(74848),d=s(28453);const a={},t=void 0,r={id:"configuration/networking-settings",title:"networking-settings",description:"---",source:"@site/docs/configuration/networking-settings.mdx",sourceDirName:"configuration",slug:"/configuration/networking-settings",permalink:"/docs/configuration/networking-settings",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/superset/edit/master/docs/docs/configuration/networking-settings.mdx",tags:[],version:"current",frontMatter:{},sidebar:"CustomSidebar",previous:{title:"Importing and Exporting Datasources",permalink:"/docs/configuration/importing-exporting-datasources"},next:{title:"Creating Your First Dashboard",permalink:"/docs/using-superset/creating-your-first-dashboard"}},o={},l=[{value:"title: Network and Security Settings\nsidebar_position: 7\nversion: 1",id:"title-network-and-security-settingssidebar_position-7version-1",level:2},{value:"CORS",id:"cors",level:2},{value:"HTTP headers",id:"http-headers",level:2},{value:"HTML Embedding of Dashboards and Charts",id:"html-embedding-of-dashboards-and-charts",level:2},{value:"Embedding a Public Direct Link to a Dashboard",id:"embedding-a-public-direct-link-to-a-dashboard",level:3},{value:"Changing flask-talisman CSP",id:"changing-flask-talisman-csp",level:4},{value:"Making a Dashboard Public",id:"making-a-dashboard-public",level:4},{value:"Embedding a Public Dashboard",id:"embedding-a-public-dashboard",level:4},{value:"Embedding a Chart",id:"embedding-a-chart",level:4},{value:"Enabling Embedding via the SDK",id:"enabling-embedding-via-the-sdk",level:3},{value:"CSRF settings",id:"csrf-settings",level:2},{value:"SSH Tunneling",id:"ssh-tunneling",level:2},{value:"Domain Sharding",id:"domain-sharding",level:2},{value:"Middleware",id:"middleware",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"title-network-and-security-settingssidebar_position-7version-1",children:"title: Network and Security Settings\nsidebar_position: 7\nversion: 1"}),"\n",(0,i.jsx)(n.h1,{id:"network-and-security-settings",children:"Network and Security Settings"}),"\n",(0,i.jsx)(n.h2,{id:"cors",children:"CORS"}),"\n",(0,i.jsx)(n.p,{children:"To configure CORS, or cross-origin resource sharing, the following dependency must be installed:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"pip install apache-superset[cors]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The following keys in ",(0,i.jsx)(n.code,{children:"superset_config.py"})," can be specified to configure CORS:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ENABLE_CORS"}),": Must be set to ",(0,i.jsx)(n.code,{children:"True"})," in order to enable CORS"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"CORS_OPTIONS"}),": options passed to Flask-CORS\n(",(0,i.jsx)(n.a,{href:"https://flask-cors.corydolphin.com/en/latest/api.html#extension",children:"documentation"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"http-headers",children:"HTTP headers"}),"\n",(0,i.jsxs)(n.p,{children:["Note that Superset bundles ",(0,i.jsx)(n.a,{href:"https://pypi.org/project/talisman/",children:"flask-talisman"}),"\nSelf-described as a small Flask extension that handles setting HTTP headers that can help\nprotect against a few common web application security issues."]}),"\n",(0,i.jsx)(n.h2,{id:"html-embedding-of-dashboards-and-charts",children:"HTML Embedding of Dashboards and Charts"}),"\n",(0,i.jsxs)(n.p,{children:["There are two ways to embed a dashboard: Using the ",(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/@superset-ui/embedded-sdk",children:"SDK"})," or embedding a direct link. Note that in the latter case everybody who knows the link is able to access the dashboard."]}),"\n",(0,i.jsx)(n.h3,{id:"embedding-a-public-direct-link-to-a-dashboard",children:"Embedding a Public Direct Link to a Dashboard"}),"\n",(0,i.jsxs)(n.p,{children:["This works by first changing the content security policy (CSP) of ",(0,i.jsx)(n.a,{href:"https://github.com/GoogleCloudPlatform/flask-talisman",children:"flask-talisman"})," to allow for certain domains to display Superset content. Then a dashboard can be made publicly accessible, i.e. ",(0,i.jsx)(n.strong,{children:"bypassing authentication"}),". Once made public, the dashboard's URL can be added to an iframe in another website's HTML code."]}),"\n",(0,i.jsx)(n.h4,{id:"changing-flask-talisman-csp",children:"Changing flask-talisman CSP"}),"\n",(0,i.jsxs)(n.p,{children:["Add to ",(0,i.jsx)(n.code,{children:"superset_config.py"})," the entire ",(0,i.jsx)(n.code,{children:"TALISMAN_CONFIG"})," section from ",(0,i.jsx)(n.code,{children:"config.py"})," and include a ",(0,i.jsx)(n.code,{children:"frame-ancestors"})," section:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'TALISMAN_ENABLED = True\nTALISMAN_CONFIG = {\n    "content_security_policy": {\n    ...\n\t"frame-ancestors": ["*.my-domain.com", "*.another-domain.com"],\n    ...\n'})}),"\n",(0,i.jsx)(n.p,{children:"Restart Superset for this configuration change to take effect."}),"\n",(0,i.jsx)(n.h4,{id:"making-a-dashboard-public",children:"Making a Dashboard Public"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Add the ",(0,i.jsx)(n.code,{children:"'DASHBOARD_RBAC': True"})," ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/master/RESOURCES/FEATURE_FLAGS.md",children:"Feature Flag"})," to ",(0,i.jsx)(n.code,{children:"superset_config.py"})]}),"\n",(0,i.jsxs)(n.li,{children:["Add the ",(0,i.jsx)(n.code,{children:"Public"})," role to your dashboard as described ",(0,i.jsx)(n.a,{href:"https://superset.apache.org/docs/using-superset/creating-your-first-dashboard/#manage-access-to-dashboards",children:"here"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"embedding-a-public-dashboard",children:"Embedding a Public Dashboard"}),"\n",(0,i.jsx)(n.p,{children:"Now anybody can directly access the dashboard's URL. You can embed it in an iframe like so:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<iframe\n  width="600"\n  height="400"\n  seamless\n  frameBorder="0"\n  scrolling="no"\n  src="https://superset.my-domain.com/superset/dashboard/10/?standalone=1&height=400"\n>\n</iframe>\n'})}),"\n",(0,i.jsx)(n.h4,{id:"embedding-a-chart",children:"Embedding a Chart"}),"\n",(0,i.jsxs)(n.p,{children:["A chart's embed code can be generated by going to a chart's edit view and then clicking at the top right on ",(0,i.jsx)(n.code,{children:"..."})," > ",(0,i.jsx)(n.code,{children:"Share"})," > ",(0,i.jsx)(n.code,{children:"Embed code"})]}),"\n",(0,i.jsx)(n.h3,{id:"enabling-embedding-via-the-sdk",children:"Enabling Embedding via the SDK"}),"\n",(0,i.jsxs)(n.p,{children:["Clicking on ",(0,i.jsx)(n.code,{children:"..."})," next to ",(0,i.jsx)(n.code,{children:"EDIT DASHBOARD"}),' on the top right of the dashboard\'s overview page should yield a drop-down menu including the entry "Embed dashboard".']}),"\n",(0,i.jsxs)(n.p,{children:["To enable this entry, add the following line to the ",(0,i.jsx)(n.code,{children:".env"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"SUPERSET_FEATURE_EMBEDDED_SUPERSET=true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"csrf-settings",children:"CSRF settings"}),"\n",(0,i.jsxs)(n.p,{children:["Similarly, ",(0,i.jsx)(n.a,{href:"https://flask-wtf.readthedocs.io/en/0.15.x/config/",children:"flask-wtf"})," is used manage\nsome CSRF configurations. If you need to exempt endpoints from CSRF (e.g. if you are\nrunning a custom auth postback endpoint), you can add the endpoints to ",(0,i.jsx)(n.code,{children:"WTF_CSRF_EXEMPT_LIST"}),":"]}),"\n",(0,i.jsx)(n.h2,{id:"ssh-tunneling",children:"SSH Tunneling"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Turn on feature flag"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Change ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/eb8386e3f0647df6d1bbde8b42073850796cc16f/superset/config.py#L489",children:(0,i.jsx)(n.code,{children:"SSH_TUNNELING"})})," to ",(0,i.jsx)(n.code,{children:"True"})]}),"\n",(0,i.jsxs)(n.li,{children:["If you want to add more security when establishing the tunnel we allow users to overwrite the ",(0,i.jsx)(n.code,{children:"SSHTunnelManager"})," class ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/eb8386e3f0647df6d1bbde8b42073850796cc16f/superset/config.py#L507",children:"here"})]}),"\n",(0,i.jsxs)(n.li,{children:["You can also set the ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/eb8386e3f0647df6d1bbde8b42073850796cc16f/superset/config.py#L508",children:(0,i.jsx)(n.code,{children:"SSH_TUNNEL_LOCAL_BIND_ADDRESS"})})," this the host address where the tunnel will be accessible on your VPC"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create database w/ ssh tunnel enabled"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"With the feature flag enabled you should now see ssh tunnel toggle."}),"\n",(0,i.jsxs)(n.li,{children:["Click the toggle to enable SSH tunneling and add your credentials accordingly.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Superset allows for two different types of authentication (Basic + Private Key). These credentials should come from your service provider."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify data is flowing"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Once SSH tunneling has been enabled, go to SQL Lab and write a query to verify data is properly flowing."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"domain-sharding",children:"Domain Sharding"}),"\n",(0,i.jsxs)(n.p,{children:["Chrome allows up to 6 open connections per domain at a time. When there are more than 6 slices in\ndashboard, a lot of time fetch requests are queued up and wait for next available socket.\n",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/pull/5039",children:"PR 5039"})," adds domain sharding to Superset,\nand this feature will be enabled by configuration only (by default Superset doesn\u2019t allow\ncross-domain request)."]}),"\n",(0,i.jsxs)(n.p,{children:["Add the following setting in your ",(0,i.jsx)(n.code,{children:"superset_config.py"})," file:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SUPERSET_WEBSERVER_DOMAINS"}),": list of allowed hostnames for domain sharding feature."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Please create your domain shards as subdomains of your main domain for authorization to\nwork properly on new domains. For Example:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"SUPERSET_WEBSERVER_DOMAINS=['superset-1.mydomain.com','superset-2.mydomain.com','superset-3.mydomain.com','superset-4.mydomain.com']"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["or add the following setting in your ",(0,i.jsx)(n.code,{children:"superset_config.py"})," file if domain shards are not subdomains of main domain."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"SESSION_COOKIE_DOMAIN = '.mydomain.com'"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"middleware",children:"Middleware"}),"\n",(0,i.jsxs)(n.p,{children:["Superset allows you to add your own middleware. To add your own middleware, update the\n",(0,i.jsx)(n.code,{children:"ADDITIONAL_MIDDLEWARE"})," key in your ",(0,i.jsx)(n.code,{children:"superset_config.py"}),". ",(0,i.jsx)(n.code,{children:"ADDITIONAL_MIDDLEWARE"})," should be a list\nof your additional middleware classes."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, to use ",(0,i.jsx)(n.code,{children:"AUTH_REMOTE_USER"})," from behind a proxy server like nginx, you have to add a\nsimple middleware class to add the value of ",(0,i.jsx)(n.code,{children:"HTTP_X_PROXY_REMOTE_USER"})," (or any other custom header\nfrom the proxy) to Gunicorn\u2019s ",(0,i.jsx)(n.code,{children:"REMOTE_USER"})," environment variable:"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>r});var i=s(96540);const d={},a=i.createContext(d);function t(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);