"use strict";(self.webpackChunkdocs_v_2=self.webpackChunkdocs_v_2||[]).push([[74],{91288:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>d,toc:()=>a});var i=s(74848),t=s(28453);const o={title:"Network and Security Settings",sidebar_position:7,version:1},r="Network and Security Settings",d={id:"configuration/networking-settings",title:"Network and Security Settings",description:"CORS",source:"@site/docs/configuration/networking-settings.mdx",sourceDirName:"configuration",slug:"/configuration/networking-settings",permalink:"/docs/configuration/networking-settings",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/superset/edit/master/docs/docs/configuration/networking-settings.mdx",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Network and Security Settings",sidebar_position:7,version:1},sidebar:"CustomSidebar",previous:{title:"Timezones",permalink:"/docs/configuration/timezones"},next:{title:"Setup SSH Tunneling",permalink:"/docs/configuration/setup-ssh-tunneling"}},l={},a=[{value:"CORS",id:"cors",level:2},{value:"HTTP headers",id:"http-headers",level:2},{value:"CSRF settings",id:"csrf-settings",level:2},{value:"SSH Tunneling",id:"ssh-tunneling",level:2},{value:"Domain Sharding",id:"domain-sharding",level:2},{value:"Middleware",id:"middleware",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"network-and-security-settings",children:"Network and Security Settings"}),"\n",(0,i.jsx)(n.h2,{id:"cors",children:"CORS"}),"\n",(0,i.jsx)(n.p,{children:"To configure CORS, or cross-origin resource sharing, the following dependency must be installed:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"pip install apache-superset[cors]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The following keys in ",(0,i.jsx)(n.code,{children:"superset_config.py"})," can be specified to configure CORS:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ENABLE_CORS"}),": Must be set to ",(0,i.jsx)(n.code,{children:"True"})," in order to enable CORS"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"CORS_OPTIONS"}),": options passed to Flask-CORS\n(",(0,i.jsx)(n.a,{href:"https://flask-cors.corydolphin.com/en/latest/api.html#extension",children:"documentation"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"http-headers",children:"HTTP headers"}),"\n",(0,i.jsxs)(n.p,{children:["Note that Superset bundles ",(0,i.jsx)(n.a,{href:"https://pypi.org/project/talisman/",children:"flask-talisman"}),"\nSelf-descried as a small Flask extension that handles setting HTTP headers that can help\nprotect against a few common web application security issues."]}),"\n",(0,i.jsx)(n.h2,{id:"csrf-settings",children:"CSRF settings"}),"\n",(0,i.jsxs)(n.p,{children:["Similarly, ",(0,i.jsx)(n.a,{href:"https://flask-wtf.readthedocs.io/en/0.15.x/config/",children:"flask-wtf"})," is used manage\nsome CSRF configurations. If you need to exempt endpoints from CSRF (e.g. if you are\nrunning a custom auth postback endpoint), you can add the endpoints to ",(0,i.jsx)(n.code,{children:"WTF_CSRF_EXEMPT_LIST"}),":"]}),"\n",(0,i.jsx)(n.h2,{id:"ssh-tunneling",children:"SSH Tunneling"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Turn on feature flag"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Change ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/eb8386e3f0647df6d1bbde8b42073850796cc16f/superset/config.py#L489",children:(0,i.jsx)(n.code,{children:"SSH_TUNNELING"})})," to ",(0,i.jsx)(n.code,{children:"True"})]}),"\n",(0,i.jsxs)(n.li,{children:["If you want to add more security when establishing the tunnel we allow users to overwrite the ",(0,i.jsx)(n.code,{children:"SSHTunnelManager"})," class ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/eb8386e3f0647df6d1bbde8b42073850796cc16f/superset/config.py#L507",children:"here"})]}),"\n",(0,i.jsxs)(n.li,{children:["You can also set the ",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/blob/eb8386e3f0647df6d1bbde8b42073850796cc16f/superset/config.py#L508",children:(0,i.jsx)(n.code,{children:"SSH_TUNNEL_LOCAL_BIND_ADDRESS"})})," this the host address where the tunnel will be accessible on your VPC"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create database w/ ssh tunnel enabled"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"With the feature flag enabled you should now see ssh tunnel toggle."}),"\n",(0,i.jsxs)(n.li,{children:["Click the toggle to enable SSH tunneling and add your credentials accordingly.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Superset allows for two different types of authentication (Basic + Private Key). These credentials should come from your service provider."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify data is flowing"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Once SSH tunneling has been enabled, go to SQL Lab and write a query to verify data is properly flowing."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"domain-sharding",children:"Domain Sharding"}),"\n",(0,i.jsxs)(n.p,{children:["Chrome allows up to 6 open connections per domain at a time. When there are more than 6 slices in\ndashboard, a lot of time fetch requests are queued up and wait for next available socket.\n",(0,i.jsx)(n.a,{href:"https://github.com/apache/superset/pull/5039",children:"PR 5039"})," adds domain sharding to Superset,\nand this feature will be enabled by configuration only (by default Superset doesn\u2019t allow\ncross-domain request)."]}),"\n",(0,i.jsxs)(n.p,{children:["Add the following setting in your ",(0,i.jsx)(n.code,{children:"superset_config.py"})," file:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SUPERSET_WEBSERVER_DOMAINS"}),": list of allowed hostnames for domain sharding feature."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Please create your domain shards as subdomains of your main domain for authorization to\nwork properly on new domains. For Example:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"SUPERSET_WEBSERVER_DOMAINS=['superset-1.mydomain.com','superset-2.mydomain.com','superset-3.mydomain.com','superset-4.mydomain.com']"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["or add the following setting in your ",(0,i.jsx)(n.code,{children:"superset_config.py"})," file if domain shards are not subdomains of main domain."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"SESSION_COOKIE_DOMAIN = '.mydomain.com'"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"middleware",children:"Middleware"}),"\n",(0,i.jsxs)(n.p,{children:["Superset allows you to add your own middleware. To add your own middleware, update the\n",(0,i.jsx)(n.code,{children:"ADDITIONAL_MIDDLEWARE"})," key in your ",(0,i.jsx)(n.code,{children:"superset_config.py"}),". ",(0,i.jsx)(n.code,{children:"ADDITIONAL_MIDDLEWARE"})," should be a list\nof your additional middleware classes."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, to use ",(0,i.jsx)(n.code,{children:"AUTH_REMOTE_USER"})," from behind a proxy server like nginx, you have to add a\nsimple middleware class to add the value of ",(0,i.jsx)(n.code,{children:"HTTP_X_PROXY_REMOTE_USER"})," (or any other custom header\nfrom the proxy) to Gunicorn\u2019s ",(0,i.jsx)(n.code,{children:"REMOTE_USER"})," environment variable:"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>d});var i=s(96540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);